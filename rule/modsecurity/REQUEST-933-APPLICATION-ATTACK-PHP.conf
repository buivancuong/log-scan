SecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 1" "id:933011,phase:1,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"

SecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 1" "id:933012,phase:2,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?:<\?(?!xml\s)|<\?php|\[(?:/|\\\\)?php\])" "id:933100,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: PHP Open Tag Found',severity:'CRITICAL',capture,t:none,t:urlDecodeUni,t:lowercase,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'attack-injection-php'"

SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X.Filename|REQUEST_HEADERS:X-File-Name "@rx .*\.(?:php\d*|phtml)\.*$" "id:933110,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: PHP Script File Upload Found',severity:'CRITICAL',capture,t:none,t:lowercase,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'attack-injection-php'"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@pmFromFile php-config-directives.data" "id:933120,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',chain,msg:'PHP Injection Attack: Configuration Directive Found',severity:'CRITICAL',capture,t:none,t:urlDecodeUni,t:normalisePath,t:lowercase,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'attack-injection-php'"
SecRule MATCHED_VARS "@pm =" "capture,setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}'"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@pmFromFile php-variables.data" "id:933130,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: Variables Found',severity:'CRITICAL',capture,t:none,t:normalisePath,t:urlDecodeUni,t:lowercase,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'attack-injection-php'"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i)php://(?:std(?:in|out|err)|(?:in|out)put|fd|memory|temp|filter)" "id:933140,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: I/O Stream Found',severity:'CRITICAL',capture,t:none,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'attack-injection-php'"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?i:zlib|glob|phar|ssh2|rar|ogg|expect|zip)://" "id:933200,phase:2,block,logdata:'Matched Data: %{MATCHED_VAR} found within %{MATCHED_VAR_NAME}',msg:'PHP Injection Attack: Wrapper scheme detected',severity:'CRITICAL',t:none,t:utf8toUnicode,t:urlDecodeUni,t:removeNulls,t:cmdLine,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'attack-injection-php'"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@pmFromFile php-function-names-933150.data" "id:933150,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: High-Risk PHP Function Name Found',severity:'CRITICAL',capture,t:none,t:lowercase,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'attack-injection-php'"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\b(?:s(?:e(?:t(?:_(?:e(?:xception|rror)_handler|magic_quotes_runtime|include_path)|defaultstub)|ssion_s(?:et_save_handler|tart))|qlite_(?:(?:(?:unbuffered|single|array)_)?query|create_(?:aggregate|function)|p?open|exec)|tr(?:eam_(?:context_create|socket_client)|ipc?slashes|rev)|implexml_load_(?:string|file)|ocket_c(?:onnect|reate)|h(?:ow_sourc|a1_fil)e|pl_autoload_register|ystem)|p(?:r(?:eg_(?:replace(?:_callback(?:_array)?)?|match(?:_all)?|split)|oc_(?:(?:terminat|clos|nic)e|get_status|open)|int_r)|o(?:six_(?:get(?:(?:e[gu]|g)id|login|pwnam)|mk(?:fifo|nod)|ttyname|kill)|pen)|hp(?:_(?:strip_whitespac|unam)e|version|info)|g_(?:(?:execut|prepar)e|connect|query)|a(?:rse_(?:ini_file|str)|ssthru)|utenv)|r(?:unkit_(?:function_(?:re(?:defin|nam)e|copy|add)|method_(?:re(?:defin|nam)e|copy|add)|constant_(?:redefine|add))|e(?:(?:gister_(?:shutdown|tick)|name)_function|ad(?:(?:gz)?file|_exif_data|dir))|awurl(?:de|en)code)|i(?:mage(?:createfrom(?:(?:jpe|pn)g|x[bp]m|wbmp|gif)|(?:jpe|pn)g|g(?:d2?|if)|2?wbmp|xbm)|s_(?:(?:(?:execut|write?|read)ab|fi)le|dir)|ni_(?:get(?:_all)?|set)|terator_apply|ptcembed)|g(?:et(?:_(?:c(?:urrent_use|fg_va)r|meta_tags)|my(?:[gpu]id|inode)|(?:lastmo|cw)d|imagesize|env)|z(?:(?:(?:defla|wri)t|encod|fil)e|compress|open|read)|lob)|a(?:rray_(?:u(?:intersect(?:_u?assoc)?|diff(?:_u?assoc)?)|intersect_u(?:assoc|key)|diff_u(?:assoc|key)|filter|reduce|map)|ssert(?:_options)?)|h(?:tml(?:specialchars(?:_decode)?|_entity_decode|entities)|(?:ash(?:_(?:update|hmac))?|ighlight)_file|e(?:ader_register_callback|x2bin))|f(?:i(?:le(?:(?:[acm]tim|inod)e|(?:_exist|perm)s|group)?|nfo_open)|tp_(?:nb_(?:ge|pu)|connec|ge|pu)t|(?:unction_exis|pu)ts|write|open)|o(?:b_(?:get_(?:c(?:ontents|lean)|flush)|end_(?:clean|flush)|clean|flush|start)|dbc_(?:result(?:_all)?|exec(?:ute)?|connect)|pendir)|m(?:b_(?:ereg(?:_(?:replace(?:_callback)?|match)|i(?:_replace)?)?|parse_str)|(?:ove_uploaded|d5)_file|ethod_exists|ysql_query|kdir)|e(?:x(?:if_(?:t(?:humbnail|agname)|imagetype|read_data)|ec)|scapeshell(?:arg|cmd)|rror_reporting|val)|c(?:url_(?:file_create|exec|init)|onvert_uuencode|reate_function|hr)|u(?:n(?:serialize|pack)|rl(?:de|en)code|[ak]?sort)|(?:json_(?:de|en)cod|debug_backtrac|tmpfil)e|b(?:(?:son_(?:de|en)|ase64_en)code|zopen)|var_dump)(?:\s|/\*.*\*/|//.*|#.*)*\(.*\)" "id:933160,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: High-Risk PHP Function Call Found',severity:'CRITICAL',capture,t:none,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'attack-injection-php'"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_HEADERS|ARGS_NAMES|ARGS|XML:/* "@rx [oOcC]:\d+:\".+?\":\d+:{.*}" "id:933170,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: Serialized Object Injection',severity:'CRITICAL',capture,t:none,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'attack-injection-php'"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@rx \$+(?:[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*|\s*{.+})(?:\s|\[.+\]|{.+}|/\*.*\*/|//.*|#.*)*\(.*\)" "id:933180,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: Variable Function Call Found',severity:'CRITICAL',capture,t:none,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'attack-injection-php'"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@rx (?:(?:\(|\[)[a-zA-Z0-9_.$\"'\[\](){}/*\s]+(?:\)|\])[0-9_.$\"'\[\](){}/*\s]*\([a-zA-Z0-9_.$\"'\[\](){}/*\s].*\)|\([\s]*string[\s]*\)[\s]*(?:\"|'))" "id:933210,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: Variable Function Call Found',severity:'CRITICAL',capture,t:none,t:urlDecode,t:replaceComments,t:compressWhitespace,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl1=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'attack-injection-php'"

SecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 2" "id:933013,phase:1,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"

SecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 2" "id:933014,phase:2,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@pmFromFile php-function-names-933151.data" "id:933151,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',chain,msg:'PHP Injection Attack: Medium-Risk PHP Function Name Found',severity:'CRITICAL',capture,t:none,t:lowercase,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'paranoia-level/2',tag:'attack-injection-php'"
SecRule MATCHED_VARS "@pm (" "capture,setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl2=+%{tx.critical_anomaly_score}'"

SecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 3" "id:933015,phase:1,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"

SecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 3" "id:933016,phase:2,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@rx (?:HTTP_(?:ACCEPT(?:_(?:ENCODING|LANGUAGE|CHARSET))?|(?:X_FORWARDED_FO|REFERE)R|(?:USER_AGEN|HOS)T|CONNECTION|KEEP_ALIVE)|PATH_(?:TRANSLATED|INFO)|ORIG_PATH_INFO|QUERY_STRING|REQUEST_URI|AUTH_TYPE)" "id:933131,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: Variables Found',severity:'CRITICAL',capture,t:none,t:normalisePath,t:urlDecodeUni,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl3=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'paranoia-level/3',tag:'attack-injection-php'"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* "@rx (?i)\b(?:i(?:s(?:_(?:in(?:t(?:eger)?|finite)|n(?:u(?:meric|ll)|an)|(?:calla|dou)ble|s(?:calar|tring)|f(?:inite|loat)|re(?:source|al)|l(?:ink|ong)|a(?:rray)?|object|bool)|set)|n(?:(?:clud|vok)e|t(?:div|val))|(?:mplod|dat)e|conv)|s(?:t(?:r(?:(?:le|sp)n|coll)|at)|(?:e(?:rializ|ttyp)|huffl)e|i(?:milar_text|zeof|nh?)|p(?:liti?|rintf)|(?:candi|ubst)r|y(?:mlink|slog)|o(?:undex|rt)|leep|rand|qrt)|f(?:ile(?:(?:siz|typ)e|owner|pro)|l(?:o(?:atval|ck|or)|ush)|(?:rea|mo)d|t(?:ell|ok)|unction|close|gets|stat|eof)|c(?:h(?:o(?:wn|p)|eckdate|root|dir|mod)|o(?:(?:(?:nsta|u)n|mpac)t|sh?|py)|lose(?:dir|log)|(?:urren|ryp)t|eil)|e(?:x(?:(?:trac|i)t|p(?:lode)?)|a(?:ster_da(?:te|ys)|ch)|r(?:ror_log|egi?)|mpty|cho|nd)|l(?:o(?:g(?:1[0p])?|caltime)|i(?:nk(?:info)?|st)|(?:cfirs|sta)t|evenshtein|trim)|d(?:i(?:(?:skfreespac)?e|r(?:name)?)|e(?:fined?|coct)|(?:oubleva)?l|ate)|r(?:e(?:(?:quir|cod|nam)e|adlin[ek]|wind|set)|an(?:ge|d)|ound|sort|trim)|m(?:b(?:split|ereg)|i(?:crotime|n)|a(?:i[ln]|x)|etaphone|y?sql|hash)|u(?:n(?:(?:tain|se)t|iqid|link)|s(?:leep|ort)|cfirst|mask)|a(?:s(?:(?:se|o)rt|inh?)|r(?:sort|ray)|tan[2h]?|cosh?|bs)|t(?:e(?:xtdomain|mpnam)|a(?:int|nh?)|ouch|ime|rim)|h(?:e(?:ader(?:s_(?:lis|sen)t)?|brev)|ypot|ash)|p(?:a(?:thinfo|ck)|r(?:intf?|ev)|close|o[sw]|i)|g(?:et(?:t(?:ext|ype)|date)|mdate)|o(?:penlog|ctdec|rd)|b(?:asename|indec)|n(?:atsor|ex)t|k(?:sort|ey)|quotemeta|wordwrap|virtual|join)(?:\s|/\*.*\*/|//.*|#.*)*\(.*\)" "id:933161,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: Low-Value PHP Function Call Found',severity:'CRITICAL',capture,t:none,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl3=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'paranoia-level/3',tag:'attack-injection-php'"

SecRule FILES|REQUEST_HEADERS:X-Filename|REQUEST_HEADERS:X_Filename|REQUEST_HEADERS:X.Filename|REQUEST_HEADERS:X-File-Name "@rx .*\.(?:php\d*|phtml)\..*$" "id:933111,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: PHP Script File Upload Found',severity:'CRITICAL',capture,t:none,t:lowercase,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl3=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'paranoia-level/3',tag:'attack-injection-php'"

SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* "@pm ?>" "id:933190,phase:2,block,logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',msg:'PHP Injection Attack: PHP Closing Tag Found',severity:'CRITICAL',capture,t:none,t:urlDecodeUni,ctl:auditLogParts=+E,ver:'OWASP_CRS/3.2.0',setvar:'tx.php_injection_score=+%{tx.critical_anomaly_score}',setvar:'tx.anomaly_score_pl3=+%{tx.critical_anomaly_score}',tag:'application-multi',tag:'language-php',tag:'platform-multi',tag:'OWASP_CRS',tag:'OWASP_CRS/WEB_ATTACK/PHP_INJECTION',tag:'OWASP_TOP_10/A1',tag:'paranoia-level/3',tag:'attack-injection-php'"

SecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 4" "id:933017,phase:1,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"

SecRule TX:EXECUTING_PARANOIA_LEVEL "@lt 4" "id:933018,phase:2,pass,nolog,skipAfter:END-REQUEST-933-APPLICATION-ATTACK-PHP"

SecMarker END-REQUEST-933-APPLICATION-ATTACK-PHP

